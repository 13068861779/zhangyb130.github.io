<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>【NDK系列12】Makefile Android.mk Application.mk 详解 | 哒哒瑟</title>
  
  <meta name="keywords" content="Android,Java,Linux">
  
  

  

  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  
  
  <meta name="theme-color" content="#FFFFFF">
  <meta name="msapplication-TileColor" content="#1BC3FB">
  <meta name="msapplication-config" content="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-favicon@19.9.6/browserconfig.xml">
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.10.1/css/all.min.css">
  
  
  <link rel="shortcut icon" type="image/x-icon" href="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-favicon@19.9.6/favicon.ico">
  <link rel="icon" type="image/x-icon" sizes="32x32" href="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-favicon@19.9.6/favicon-32x32.png">
  <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-favicon@19.9.6/apple-touch-icon.png">
  <link rel="mask-icon" color="#1BC3FB" href="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-favicon@19.9.6/safari-pinned-tab.svg">
  <link rel="manifest" href="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-favicon@19.9.6/site.webmanifest">
  

  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-material-x@19.10.22/css/style.css">
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  
  <header class="l_header pure">
  <div id="loading-bar-wrapper">
    <div id="loading-bar" class="pure"></div>
  </div>

	<div class="wrapper">
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href="/">
        
          <img class="logo" src="/assets/logo.png">
        
      </a>
			<div class="menu navgation">
				<ul class="h-list">
          
  					
  						<li>
								<a class="nav flat-box" href="/" id="home">
									<i class="fas fa-grin fa-fw"></i>&nbsp;博文
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/blog/categories/" rel="nofollow" id="blogcategories">
									<i class="fas fa-folder-open fa-fw"></i>&nbsp;分类
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/blog/tags/" rel="nofollow" id="blogtags">
									<i class="fas fa-hashtag fa-fw"></i>&nbsp;标签
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/blog/archives/" rel="nofollow" id="blogarchives">
									<i class="fas fa-archive fa-fw"></i>&nbsp;归档
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="搜索">
						<i class="icon fas fa-search fa-fw"></i>
					</form>
				</div>
			
			<ul class="switcher h-list">
				
					<li class="s-search"><a class="fas fa-search fa-fw" href="javascript:void(0)"></a></li>
				
				<li class="s-menu"><a class="fas fa-bars fa-fw" href="javascript:void(0)"></a></li>
			</ul>
		</div>

		<div class="nav-sub container container--flex">
			<a class="logo flat-box"></a>
			<ul class="switcher h-list">
				<li class="s-comment"><a class="flat-btn fas fa-comments fa-fw" href="javascript:void(0)"></a></li>
        
          <li class="s-toc"><a class="flat-btn fas fa-list fa-fw" href="javascript:void(0)"></a></li>
        
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu navgation">
      <ul>
        
          
            <li>
							<a class="nav flat-box" href="/" id="home">
								<i class="fas fa-clock fa-fw"></i>&nbsp;近期文章
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/blog/archives/" rel="nofollow" id="blogarchives">
								<i class="fas fa-archive fa-fw"></i>&nbsp;文章归档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/projects/" id="projects">
								<i class="fas fa-code-branch fa-fw"></i>&nbsp;开源项目
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/about/" rel="nofollow" id="about">
								<i class="fas fa-info-circle fa-fw"></i>&nbsp;关于小站
							</a>
            </li>
          
       
      </ul>
		</nav>
    </header>
	</aside>
<script>setLoadingBarProgress(40);</script>



  <div class="l_body nocover">
    <div class='body-wrapper'>
      <div class="l_main">
  

  <article id="post" class="post white-box article-type-post" itemscope="" itemprop="blogPost">
    


  <section class="meta">
    
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/android/ndk/ndk-12/">
        【NDK系列12】Makefile Android.mk Application.mk 详解
      </a>
    </h1>
  


      
      <div class="new-meta-box">
        
          
        
          
            
  <div class="new-meta-item author">
    
      <a href="https://ddssingsong.github.io" rel="nofollow">
        
          <i class="fas fa-user" aria-hidden="true"></i>
        
        <p>大大帅</p>
      </a>
    
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class="notlink">
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2019-10-06</p>
  </a>
</div>

          
        
          
            
  
  <div class="new-meta-item category">
    <a href="/blog/categories/Android/NDK/" rel="nofollow">
      <i class="fas fa-folder-open" aria-hidden="true"></i>
      <p>Android&nbsp;/&nbsp;NDK</p>
    </a>
  </div>


          
        
          
            
  
    <div class="new-meta-item browse busuanzi">
      <a class="notlink">
        <i class="fas fa-eye" aria-hidden="true"></i>
        <p>
          <span id="busuanzi_value_page_pv">
            <i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i>
          </span>
        </p>
      </a>
    </div>
  


          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


    <section class="article typo">
      <div class="article-entry" itemprop="articleBody">
        <p>我们在使用第三方库时，很多都提供makefile，我们需要读懂他们并且适当的修改他们，另外虽说现在google推荐使用cmake，但是如果遇见Android.mk还是需要能够读懂。</p>
<a id="more"></a>
<h2 id="一、什么是Makefile"><a href="#一、什么是Makefile" class="headerlink" title="一、什么是Makefile"></a>一、什么是Makefile</h2><p>无论是c、c++首先要把源文件编译成中间代码文件，在Windows下也就是 .obj 文件，UNIX下是 .o 文件，即 Object File，这个动作叫做<code>编译（compile）</code>，然后再把大量的Object File合成执行文件或者静动态库，这个动作叫作<code>链接（link）</code>。</p>
<p>一个工程中的源文件不计数，其按类型、功能、模块分别放在若干个目录中，makefile定义了一系列的规则来指定，哪些文件需要先编译，哪些文件需要后编译，如何进行链接等等操作。</p>
<p>makefile 就是“自动化编译”，告诉make命令如何编译和链接,即make工具的配置脚本。</p>
<p>默认的情况下，gun make命令会在当前目录下按顺序找寻文件</p>
<p>“GNUmakefile”</p>
<p>“makefile”</p>
<p>“Makefile”</p>
<p>最好不要用“GNUmakefile”，这个文件是GNU的make识别的（Windows Nmake就不识别）</p>
<p> 当然，也可以使用别的文件名来书写Makefile，比如：“Make.Linux”，“Make.android”。这样在使用时候就需要 <code>make -f XX 或者 make --file XX。</code></p>
<h2 id="二、Makefile规则"><a href="#二、Makefile规则" class="headerlink" title="二、Makefile规则"></a>二、Makefile规则</h2><h3 id="1-基本用法"><a href="#1-基本用法" class="headerlink" title="1. 基本用法"></a>1. 基本用法</h3><p>在Makefile中的命令，必须要以[Tab]键开始。</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">在Makefile中的命令，必须要以[Tab]键开始。</span><br><span class="line"></span><br><span class="line">target : prerequisites ...(预备知识，先决条件)</span><br><span class="line">	command（指令）</span><br><span class="line">-----------------------------------------------------------------------------------------</span><br><span class="line">      target也就是一个目标文件，可以是Object File，也可以是执行文件。还可以是一个标签。</span><br><span class="line">      prerequisites 要生成那个target所需要的文件或是其他target。</span><br><span class="line">      command也就是make需要执行的命令。（任意的Shell命令）</span><br></pre></td></tr></table></figure>
<p>如下例子</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># g++ -o  指定生成可执行文件的名称</span></span><br><span class="line"><span class="comment"># 下面的方法就是将main.o和test.o编译成test可执行程序test</span></span><br><span class="line"><span class="section">test:main.o test1.o</span></span><br><span class="line">	g++ -o test main.o test1.o</span><br></pre></td></tr></table></figure>
<p>当然也可以直接编译cpp</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># \ 是换行连接符 便于Makefile的易读,不用都挤在一行</span></span><br><span class="line"><span class="section">test2:</span></span><br><span class="line">	g++ -o test2 main.cpp \</span><br><span class="line">test1.cpp</span><br></pre></td></tr></table></figure>
<p>clean </p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm test main.o test.o</span><br></pre></td></tr></table></figure>
<p>打印数据</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">print:</span></span><br><span class="line">	echo <span class="string">"hello world"</span></span><br></pre></td></tr></table></figure>
<h3 id="2-变量"><a href="#2-变量" class="headerlink" title="2. 变量"></a>2. 变量</h3><p>如果比较复杂的情况，比如文件很多，target目标比较多，那么我们如果来修改，比如增加一个.cpp文件，</p>
<p>那可能需要在很多地方都写一下，也容易出错。为了易于维护，可以在makefile中使用变量。</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#声明变量</span></span><br><span class="line">objects=main.o T1.o</span><br><span class="line"><span class="comment">#mac上自动编译 main.o</span></span><br><span class="line"><span class="section">test:$&#123;objects&#125;</span></span><br><span class="line">	g++ -o test $&#123;objects&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm test $&#123;objects&#125;</span><br><span class="line">	</span><br><span class="line"><span class="comment">#======================================</span></span><br><span class="line"><span class="comment"># *.c 表示所有后缀为c的文件。</span></span><br><span class="line"><span class="comment"># 让通配符在变量中(当前目录下所有 .c 文件)</span></span><br><span class="line">objects = <span class="variable">$(<span class="built_in">wildcard</span> *.c)</span></span><br><span class="line">test : $&#123;objects&#125;</span><br><span class="line">        gcc -o test $&#123;objects&#125;</span><br><span class="line">clean :</span><br><span class="line">        rm test $&#123;obects&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-include"><a href="#3-include" class="headerlink" title="3. include"></a>3. include</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> make.clean</span><br><span class="line"></span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line"></span><br><span class="line">mk=make.clean</span><br><span class="line"><span class="keyword">include</span> $&#123;mk&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-文件搜索"><a href="#4-文件搜索" class="headerlink" title="4. 文件搜索"></a>4. 文件搜索</h3><p>在一些大的工程中，有大量的源文件存放在不同的目录中,最好的方法是把一个路径告诉make，让make在自动去找。<br>Makefile文件中的特殊变量<code>VPATH</code>就是完成这个功能的</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#默认先查找当前目录再查找当前目录下的a、b、c目录</span></span><br><span class="line">VPATH = a:b:c</span><br><span class="line">OBJ=a.o b.o c.o main.o</span><br><span class="line"></span><br><span class="line">test : <span class="variable">$(OBJ)</span></span><br><span class="line">        gcc -o  test  <span class="variable">$(OBJ)</span></span><br><span class="line">clean :</span><br><span class="line">        rm test <span class="variable">$(OBJ)</span></span><br></pre></td></tr></table></figure>
<h3 id="5-预定义变量"><a href="#5-预定义变量" class="headerlink" title="5. 预定义变量"></a>5. 预定义变量</h3><table>
<thead>
<tr>
<th>命令变量</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>AR</td>
<td>函数库的打包程序，默认为”ar”</td>
</tr>
<tr>
<td>AS</td>
<td>汇编语言编译程序,默认为”as”</td>
</tr>
<tr>
<td>CC</td>
<td>C语言编译程序,默认命令是”cc”</td>
</tr>
<tr>
<td>CXX</td>
<td>C++语言编译程序,默认命令是”g++”</td>
</tr>
<tr>
<td>RM</td>
<td>文件删除程序的名称,默认值为 rm –f</td>
</tr>
<tr>
<td>ARFLAGS</td>
<td>库文件维护程序的选项,无默认值</td>
</tr>
<tr>
<td>ASFLAGS</td>
<td>汇编程序的选项,无默认值</td>
</tr>
<tr>
<td>CFLAGS</td>
<td>C 编译器的选项,无默认值</td>
</tr>
<tr>
<td>CPPFLAGS</td>
<td>C 预编译的选项,无默认值</td>
</tr>
<tr>
<td>CXXFLAGS</td>
<td>C++编译器的选项,无默认值</td>
</tr>
</tbody>
</table>
<h3 id="6-自动变量"><a href="#6-自动变量" class="headerlink" title="6. 自动变量"></a>6. 自动变量</h3><blockquote>
<p>$@  <code>target的名字</code>  </p>
</blockquote>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">main.o:main.c</span></span><br><span class="line">	gcc -c main.c -o main.o</span><br><span class="line"><span class="comment">#使用 $@ 代替 main.o</span></span><br><span class="line"><span class="section">main.o:main.c</span></span><br><span class="line">	gcc -c main.c -o <span class="variable">$@</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>$&lt;  <code>target依赖的第一个依赖文件名</code></p>
</blockquote>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">main.o:main.c a.h b.h</span></span><br><span class="line">	gcc -c main.c -o main.o</span><br><span class="line"><span class="comment">#使用 $&lt; 代替 main.c</span></span><br><span class="line"><span class="section">main.o:main.c a.h b.h</span></span><br><span class="line">	gcc -c <span class="variable">$&lt;</span> -o main.o</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>变量</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>$*</td>
<td>不包含扩展名的target文件名称</td>
</tr>
<tr>
<td>$+</td>
<td>所有的依赖文件,以空格分开,并以出现的先后为序,可能包含 重复的依赖文件</td>
</tr>
<tr>
<td>$?</td>
<td>所有时间戳比target文件晚的依赖文件,并以空格分开</td>
</tr>
<tr>
<td>$^</td>
<td>所有不重复的依赖文件,以空格分开</td>
</tr>
</tbody>
</table>
<h3 id="7-条件语句"><a href="#7-条件语句" class="headerlink" title="7. 条件语句"></a>7. 条件语句</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(CC)</span>,gcc)</span><br><span class="line">        <span class="variable">$(CC)</span> -o foo <span class="variable">$(objects)</span> <span class="variable">$(libs_for_gcc)</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">        <span class="variable">$(CC)</span> -o foo <span class="variable">$(objects)</span> <span class="variable">$(normal_libs)</span></span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure>
<h3 id="8-输出信息"><a href="#8-输出信息" class="headerlink" title="8. 输出信息"></a>8. 输出信息</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AAA=123456</span><br><span class="line"><span class="comment">#输出变量AAA</span></span><br><span class="line"><span class="variable">$(<span class="built_in">warning</span> <span class="variable">$(AAA)</span>)</span></span><br><span class="line"><span class="variable">$(info <span class="variable">$(AAA)</span>)</span></span><br></pre></td></tr></table></figure>
<h2 id="三、Android-mk"><a href="#三、Android-mk" class="headerlink" title="三、Android.mk"></a>三、Android.mk</h2><p>微小 GNU makefile 片段。</p>
<p>将源文件分组为<em>模块</em>。 模块是静态库、共享库或独立可执行文件。 可在每个 <code>Android.mk</code> 文件中定义一个或多个模块，也可在多个模块中使用同一个源文件。</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#源文件在的位置。宏函数 my-dir 返回当前目录</span></span><br><span class="line">LOCAL_PATH := <span class="variable">$(<span class="built_in">call</span> my-<span class="built_in">dir</span>)</span></span><br><span class="line"><span class="comment">#可为您清除变量</span></span><br><span class="line"><span class="comment">#不会清理 LOCAL_PATH 变量</span></span><br><span class="line"><span class="keyword">include</span> <span class="variable">$(CLEAR_VARS)</span></span><br><span class="line"><span class="comment">#存储您要构建的模块的名称 每个模块名称必须唯一，且不含任何空格</span></span><br><span class="line"><span class="comment">#如果模块名称的开头已是 lib，则构建系统不会附加额外的前缀 lib；而是按原样采用模块名称，并添加 .so 扩展名。</span></span><br><span class="line">LOCAL_MODULE := hello-jni</span><br><span class="line"><span class="comment">#包含要构建到模块中的 C 和/或 C++ 源文件列表 以空格分开</span></span><br><span class="line">LOCAL_SRC_FILES := hello-jni.c</span><br><span class="line"><span class="comment">#构建动态库</span></span><br><span class="line"><span class="keyword">include</span> <span class="variable">$(BUILD_SHARED_LIBRARY)</span></span><br></pre></td></tr></table></figure>
<h3 id="1-变量和宏"><a href="#1-变量和宏" class="headerlink" title="1. 变量和宏"></a>1. 变量和宏</h3><p>定义自己的任意变量。在定义变量时请注意，NDK 构建系统会预留以下变量名称：</p>
<ul>
<li>以 <code>LOCAL_</code> 开头的名称，例如 <code>LOCAL_MODULE</code>。</li>
<li>以 <code>PRIVATE_</code>、<code>NDK_</code> 或 <code>APP</code> 开头的名称。构建系统在内部使用这些变量。</li>
<li>小写名称，例如 <code>my-dir</code>。构建系统也是在内部使用这些变量。</li>
</ul>
<p>如果为了方便而需要在 <code>Android.mk</code> 文件中定义自己的变量，建议在名称前附加 <code>MY_</code>。</p>
<h3 id="2-常用内置变量"><a href="#2-常用内置变量" class="headerlink" title="2. 常用内置变量"></a>2. 常用内置变量</h3><table>
<thead>
<tr>
<th>变量名</th>
<th>含义</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>BUILD_STATIC_LIBRARY</td>
<td>构建静态库的Makefile脚本</td>
<td>include $(BUILD_STATIC_LIBRARY)</td>
</tr>
<tr>
<td>PREBUILT_SHARED_LIBRARY</td>
<td>预编译共享库的Makeifle脚本</td>
<td>include $(PREBUILT_SHARED_LIBRARY)</td>
</tr>
<tr>
<td>PREBUILT_STATIC_LIBRARY</td>
<td>预编译静态库的Makeifle脚本</td>
<td>include $(PREBUILT_STATIC_LIBRARY)</td>
</tr>
<tr>
<td>TARGET_PLATFORM</td>
<td>Android API 级别号</td>
<td>TARGET_PLATFORM := android-22</td>
</tr>
<tr>
<td>TARGET_ARCH</td>
<td>CUP架构</td>
<td>arm arm64 x86 x86_64</td>
</tr>
<tr>
<td>TARGET_ARCH_ABI</td>
<td>CPU架构</td>
<td>armeabi  armeabi-v7a  arm64-v8a</td>
</tr>
</tbody>
</table>
<p><strong>模块描述变量</strong></p>
<table>
<thead>
<tr>
<th>变量名</th>
<th>描述</th>
<th>例</th>
</tr>
</thead>
<tbody>
<tr>
<td>LOCAL_MODULE_FILENAME</td>
<td>覆盖构建系统默认用于其生成的文件的名称</td>
<td>LOCAL_MODULE := foo LOCAL_MODULE_FILENAME := libnewfoo</td>
</tr>
<tr>
<td>LOCAL_CPP_FEATURES</td>
<td>特定 C++ 功能</td>
<td>支持异常:LOCAL_CPP_FEATURES := exceptions</td>
</tr>
<tr>
<td>LOCAL_C_INCLUDES</td>
<td>头文件目录查找路径</td>
<td>LOCAL_C_INCLUDES := $(LOCAL_PATH)/include</td>
</tr>
<tr>
<td>LOCAL_CFLAGS</td>
<td>构建 C <em>和</em> C++ 的编译参数</td>
<td></td>
</tr>
<tr>
<td>LOCAL_CPPFLAGS</td>
<td>c++</td>
<td></td>
</tr>
<tr>
<td>LOCAL_STATIC_LIBRARIES</td>
<td>当前模块依赖的静态库模块列表</td>
<td></td>
</tr>
<tr>
<td>LOCAL_SHARED_LIBRARIES</td>
<td></td>
<td></td>
</tr>
<tr>
<td>LOCAL_WHOLE_STATIC_LIBRARIES</td>
<td>–whole-archive</td>
<td>将未使用的函数符号也加入编译进入这个模块</td>
</tr>
<tr>
<td>LOCAL_LDLIBS</td>
<td>依赖 系统库</td>
<td>LOCAL_LDLIBS := -lz</td>
</tr>
</tbody>
</table>
<p>导出给引入模块的模块使用</p>
<p>LOCAL_EXPORT_CFLAGS</p>
<p>LOCAL_EXPORT_CPPFLAGS</p>
<p>LOCAL_EXPORT_C_INCLUDES</p>
<p>LOCAL_EXPORT_LDLIBS</p>
<h3 id="3-引入其他模块"><a href="#3-引入其他模块" class="headerlink" title="3. 引入其他模块"></a>3. 引入其他模块</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将一个新的路径加入NDK_MODULE_PATH变量</span></span><br><span class="line"><span class="comment">#NDK_MODULE_PATH 变量是系统环境变量</span></span><br><span class="line"><span class="variable">$(<span class="built_in">call</span> import-add-path,<span class="variable">$(LOCAL_PATH)</span>/platform/third_party/android/prebuilt)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#包含CocosDenshion/android目录下的mk文件</span></span><br><span class="line"><span class="variable">$(<span class="built_in">call</span> import-module,CocosDenshion/android)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#这里即为 我需要引入 CocosDenshion/android 下面的Android.mk</span></span><br><span class="line"><span class="comment">#CocosDenshion/android 的路径会从 $(LOCAL_PATH)/platform/third_party/android/prebuilt 去查找</span></span><br></pre></td></tr></table></figure>
<h2 id="四、Application-mk"><a href="#四、Application-mk" class="headerlink" title="四、Application.mk"></a>四、Application.mk</h2><h3 id="1-配置"><a href="#1-配置" class="headerlink" title="1. 配置"></a>1. 配置</h3><p>同样是GNU Makefile 片段,在Application.mk中定义一些全局(整个项目)的配置</p>
<p><strong>APP_OPTIM</strong></p>
<p>将此可选变量定义为 <code>release</code> 或 <code>debug</code>。在构建应用的模块时可使用它来更改优化级别。发行模式是默认模式，可生成高度优化的二进制文件。调试模式会生成未优化的二进制文件，更容易调试。</p>
<p><strong>APP_CFLAGS</strong></p>
<p>为任何模块编译任何 C 或 C++ 源代码时传递到编译器的一组 C 编译器标志</p>
<p><strong>APP_CPPFLAGS</strong></p>
<p>构建 C++ 源文件时传递到编译器的一组 C++ 编译器标志。</p>
<p><strong>APP_ABI</strong></p>
<p>需要生成的cpu架构(ndk r17之上 只支持：armeabi-v7a, arm64-v8a, x86, x86_64)</p>
<p><strong>APP_PLATFORM</strong></p>
<p>此变量包含目标 Android 平台的名称。例如，<code>android-3</code> 指定 Android 1.5 系统映像</p>
<p><strong>APP_STL</strong></p>
<p>默认情况下，NDK 构建系统为 Android 系统提供的最小 C++ 运行时库 (<code>system/lib/libstdc++.so</code>) 提供 C++ 功能。 </p>
<h3 id="2-APP-ABI架构"><a href="#2-APP-ABI架构" class="headerlink" title="2. APP_ABI架构"></a>2. APP_ABI架构</h3><p>不同 Android 手机使用不同的 CPU，因此支持不同的指令集。</p>
<p><strong>armeabi</strong></p>
<p>此 ABI 适用于基于 ARM、至少支持 ARMv5TE 指令集的 CPU。此 ABI 不支持硬件辅助的浮点计算。 相反，所有浮点运算都使用编译器 <code>libgcc.a</code> 静态库中的软件帮助程序函数。</p>
<p><strong>armeabi-v7a</strong></p>
<p><code>armeabi-v7a</code> ABI 使用 <code>-mfloat-abi=softfp</code> 开关强制实施规则，要求编译器在函数调用时必须传递核心寄存器对中的所有双精度值，而不是专用浮点值。 系统可以使用 FP 寄存器执行所有内部计算。 这样可极大地加速计算。</p>
<p>如果要以 armeabi-v7a ABI 为目标，则必须设置下列标志：</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CFLAGS= -march=armv7-a -mfloat-abi=softfp -mfpu=vfpv3-d16</span><br></pre></td></tr></table></figure>
<p><strong>arm64-v8a</strong></p>
<p>此 ABI 适用于基于 ARMv8、支持 AArch64 的 CPU。它还包含 NEON 和 VFPv4 指令集。</p>
<p><strong>x86</strong></p>
<p>此 ABI 适用于支持通常称为“x86”或“IA-32”的指令集的 CPU。设置的标志如：</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-march=i686 -mtune=intel -mssse3 -mfpmath=sse -m32</span><br></pre></td></tr></table></figure>
<p><strong>x86_64</strong></p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-march=x86-64 -msse4.2 -mpopcnt -m64 -mtune=intel</span><br></pre></td></tr></table></figure>
<p>现在手机主要是armeabi-v7a。查看手机cpu：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adb shell cat /proc/cpuinfo</span><br><span class="line">adb shell getprop ro.product.cpu.abi</span><br></pre></td></tr></table></figure>
<p>apk在安装的时候，如果手机是armeabi-v7a的，则会首先查看apk中是否存在armeabi-v7a目录，如果没有就会查找armeabi。</p>
<p><strong>保证cpu目录下so数量一致。</strong></p>
<pre><code>如果目标是armeabi-v7a，但是拥有一个armeabi的，也可以把它放到armeabi-v7a目录下。但是反过来不行
</code></pre><table>
<thead>
<tr>
<th>ABI(横 so)/CPU(竖 手机)</th>
<th>armeabi</th>
<th>armeabi-v7a</th>
<th>arm64-v8a</th>
<th>x86</th>
<th>x86_64</th>
</tr>
</thead>
<tbody>
<tr>
<td>ARMV5</td>
<td>支持</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ARMV7</td>
<td>支持</td>
<td>支持</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ARMV8</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
<td></td>
<td></td>
</tr>
<tr>
<td>X86</td>
<td></td>
<td></td>
<td></td>
<td>支持</td>
<td></td>
</tr>
<tr>
<td>X86_64</td>
<td></td>
<td></td>
<td></td>
<td>支持</td>
<td>支持</td>
</tr>
</tbody>
</table>

      </div>
      
        <br>
        


  <section class="meta" id="footer-meta">
    <div class="new-meta-box">
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2019-10-31T18:01:57+08:00">
  <a class="notlink">
    <i class="fas fa-clock" aria-hidden="true"></i>
    <p>更新于 2019年10月31日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/blog/tags/NDK/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>NDK</p></a></div>


        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="QQ好友" rel="external nofollow noopener noreferrer" href="http://connect.qq.com/widget/shareqq/index.html?url=https://ddssingsong.github.io/android/ndk/ndk-12/&title=【NDK系列12】Makefile Android.mk Application.mk 详解 | 哒哒瑟&summary=我们在使用第三方库时，很多都提供makefile，我们需要读懂他们并且适当的修改他们，另外虽说现在google推荐使用cmake，但是如果遇见Android.mk还是需要能够读懂。">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="QQ空间" rel="external nofollow noopener noreferrer" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://ddssingsong.github.io/android/ndk/ndk-12/&title=【NDK系列12】Makefile Android.mk Application.mk 详解 | 哒哒瑟&summary=我们在使用第三方库时，很多都提供makefile，我们需要读懂他们并且适当的修改他们，另外虽说现在google推荐使用cmake，但是如果遇见Android.mk还是需要能够读懂。">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="qrcode" rel="external nofollow noopener noreferrer" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACMElEQVR42u3ay07DMBAF0P7/T5ctEgrcOw6I2MerKkpdny5GnsfrFa/3l/X5+dU7X9+/2vPqyc0LAwPjsYzk55PDJc9bdvHXYGBgHMC4imCzd9owmuzzw5kxMDAwgkPcFToxMDAw7mK0CWeyw/dJMgYGBkYSLvNrXx528/1vy8UxMDAeyGjD5V9+/pX+BgYGxqMY73LNrnR5O2G2MDAw9mbkAW6lbZk0QduAi4GBcQ6jLagl5bCk3N+Ohf0Aw8DA2JoxG4yYNThXAvf3fwQGBsYJjLb4NUtf10t7UQMVAwNjO8ZsJGvGS0pswxEQDAyMrRlt4Swv688Cbj6csVQXxMDAeDgjKY3lW7dt0TYBLm64GBgYj2XMEtQ2pLYBN78gYmBgnMDIC21t0JyV4dqgX9cLMTAwHsjIByDalHUWgttBDQwMjBMYRYczTkpnQTYfOIswGBgYWzPyZsBSo3HUoqgTYwwMjC0Ys9ZjfjXM0+DZsAUGBsYJjPXRhyQNXg+1KwMcGBgYezBWUs3ZIfIAnX/GwMA4h9FeGWeNyVk5bzipgYGBsREj/0JebmvBS+fEwMDYlPEu16zo1pbP2ssiBgbG3oz16npenmsLdsnRb2sSYGBg/HvG+oBXHnZXAm49coGBgbEdo01WZ/g87A5TWQwMDIybAnQSWJOw/kquuxgYGEcykotdO06R73lJwsDAOICR/OQsWc3T0ZaKgYFxDiNPHduuQluwuwuJgYGxEeMDmlVBz+DRy2QAAAAASUVORK5CYII=">
        
          <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/wechat.png">
        
        </a>
      
    
      
        <a class="-mob-share-weibo" title="微博" rel="external nofollow noopener noreferrer" href="http://service.weibo.com/share/share.php?url=https://ddssingsong.github.io/android/ndk/ndk-12/&title=【NDK系列12】Makefile Android.mk Application.mk 详解 | 哒哒瑟&summary=我们在使用第三方库时，很多都提供makefile，我们需要读懂他们并且适当的修改他们，另外虽说现在google推荐使用cmake，但是如果遇见Android.mk还是需要能够读懂。">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


      
      
          <div class="prev-next">
              
                  <section class="prev">
                      <span class="art-item-left">
                          <h6><i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;上一页</h6>
                          <h4>
                              <a href="/android/ndk/ndk-13/" rel="prev" title="【NDK系列13】Cmake详解 CMakeLists.txt详细配置">
                                
                                    【NDK系列13】Cmake详解 CMakeLists.txt详细配置
                                
                              </a>
                          </h4>
                          
                              
                              <h6 class="tags">
                                  <a class="tag" href="/blog/tags/NDK/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> NDK</a>
                              </h6>
                          
                      </span>
                  </section>
              
              
                  <section class="next">
                      <span class="art-item-right" aria-hidden="true">
                          <h6>下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                          <h4>
                              <a href="/android/ndk/ndk-11/" rel="prev" title="【NDK系列11】编译器 clang gcc g++">
                                  
                                      【NDK系列11】编译器 clang gcc g++
                                  
                              </a>
                          </h4>
                          
                              
                              <h6 class="tags">
                                  <a class="tag" href="/blog/tags/NDK/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> NDK</a>
                              </h6>
                          
                      </span>
                  </section>
              
          </div>
      
    </section>
  </article>



  <!-- 显示推荐文章和评论 -->



  <article class="post white-box comments">
    <section class="article typo">
      <h4><i class="fas fa-comments fa-fw" aria-hidden="true"></i>&nbsp;评论</h4>
      
      
      
      
        <section id="comments">
          <div id="valine_container" class="valine_thread">
            <i class="fas fa-spinner fa-spin fa-fw"></i>
          </div>
        </section>
      
    </section>
  </article>






<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: '【NDK系列12】Makefile Android.mk Application.mk 详解',
      tools: true
    }
  </script>


</div>
<aside class="l_side">
  
    
    
      
        
          
          
        
          
          
        
          
          
        
          
          
            
              
  <section class="widget category">
    
<header class="pure">
  <div><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;文章分类</div>
  
    <a class="rightBtn" rel="nofollow" href="/blog/categories/" title="blog/categories/">
    <i class="fas fa-expand-arrows-alt fa-fw"></i></a>
  
</header>

    <div class="content pure">
      <ul class="entry">
        
          <li><a class="flat-box" title="/blog/categories/Android/" href="/blog/categories/Android/"><div class="name">Android</div><div class="badge">(13)</div></a></li>
        
          <li><a class="flat-box child" title="/blog/categories/Android/NDK/" href="/blog/categories/Android/NDK/"><div class="name">NDK</div><div class="badge">(13)</div></a></li>
        
          <li><a class="flat-box" title="/blog/categories/Hexo/" href="/blog/categories/Hexo/"><div class="name">Hexo</div><div class="badge">(11)</div></a></li>
        
          <li><a class="flat-box child" title="/blog/categories/Hexo/hexo/" href="/blog/categories/Hexo/hexo/"><div class="name">hexo</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box child" title="/blog/categories/Hexo/materialX/" href="/blog/categories/Hexo/materialX/"><div class="name">materialX</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box child" title="/blog/categories/Hexo/教程/" href="/blog/categories/Hexo/教程/"><div class="name">教程</div><div class="badge">(9)</div></a></li>
        
      </ul>
    </div>
  </section>


            
          
        
          
          
        
          
          
        
          
          
        
      
        
          
          
        
          
          
            
              
  <section class="widget toc-wrapper">
    
<header class="pure">
  <div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;本文目录</div>
  
    <!-- <div class='wrapper'><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div> -->
  
</header>

    <div class="content pure">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、什么是Makefile"><span class="toc-text">一、什么是Makefile</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、Makefile规则"><span class="toc-text">二、Makefile规则</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-基本用法"><span class="toc-text">1. 基本用法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-变量"><span class="toc-text">2. 变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-include"><span class="toc-text">3. include</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-文件搜索"><span class="toc-text">4. 文件搜索</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-预定义变量"><span class="toc-text">5. 预定义变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-自动变量"><span class="toc-text">6. 自动变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-条件语句"><span class="toc-text">7. 条件语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-输出信息"><span class="toc-text">8. 输出信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、Android-mk"><span class="toc-text">三、Android.mk</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-变量和宏"><span class="toc-text">1. 变量和宏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-常用内置变量"><span class="toc-text">2. 常用内置变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-引入其他模块"><span class="toc-text">3. 引入其他模块</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、Application-mk"><span class="toc-text">四、Application.mk</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-配置"><span class="toc-text">1. 配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-APP-ABI架构"><span class="toc-text">2. APP_ABI架构</span></a></li></ol></li></ol>
    </div>
  </section>


            
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
      
    

  
</aside>

<footer id="footer" class="clearfix">
  
  
    <div class="social-wrapper">
      
        
          <a href="/atom.xml" class="social fas fa-rss flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="mailto:ddssingsong@163.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://github.com/ddssingsong" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://music.163.com/#/song?id=523696075" class="social fas fa-headphones-alt flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
          </a>
        
      
    </div>
  
  <br>
  <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
  <div>
    本站使用
    <a href="https://xaoxuu.com/wiki/material-x/" target="_blank" class="codename">Material X</a>
    作为主题
    
      ，
      总访问量为
      <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span>
      次
    
    。
  </div>
</footer>
<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>

<script src="//instant.page/1.2.2" type="module" integrity="sha384-2xV8M5griQmzyiY3CDqh1dn4z3llDVqZDqzjzcY+jCBCk/a5fXJmuZ/40JJAPeoU"></script>


  <script async src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      const $reveal = $('.reveal');
      if ($reveal.length === 0) return;
      const sr = ScrollReveal({ distance: 0 });
      sr.reveal('.reveal');
    });
  </script>


  <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>




  
  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
    <script type="text/javascript">
      $(function(){
        if ('.cover') {
          $('.cover').backstretch(
          ["https://img.vim-cn.com/29/91197b04c13f512f734a76d4ac422d89dbe229.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        } else {
          $.backstretch(
          ["https://img.vim-cn.com/29/91197b04c13f512f734a76d4ac422d89dbe229.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        }
      });
    </script>
  









  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  
    
      <script src="https://cdn.jsdelivr.net/gh/xaoxuu/volantis@1.0.6/js/volantis.min.js"></script>
    
  
  <script>
  var GUEST_INFO = ['nick','mail','link'];
  var guest_info = 'nick,mail,link'.split(',').filter(function(item){
    return GUEST_INFO.indexOf(item) > -1
  });
  var notify = 'true' == true;
  var verify = 'true' == true;
  var valine = new Valine();
  valine.init({
    el: '#valine_container',
    notify: notify,
    verify: verify,
    guest_info: guest_info,
    
    appId: "StY0COESh8VDhgtMxTvWGoKm-gzGzoHsz",
    appKey: "EIDNpekxDzlRSLk36J1yYqGX",
    placeholder: "快来评论吧~",
    pageSize:'10',
    avatar:'mp',
    lang:'zh-cn',
    highlight:'true'
  })
  </script>



  <script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-material-x@19.9/js/app.js"></script>


  <script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-material-x@19.9/js/search.js"></script>




<!-- 复制 -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  let COPY_SUCCESS = "复制成功";
  let COPY_FAILURE = "复制失败";
  /*页面载入完成后，创建复制按钮*/
  !function (e, t, a) {
    /* code */
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '  <i class="fa fa-copy"></i><span>复制</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });

      clipboard.on('success', function(e) {
        //您可以加入成功提示
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        success_prompt(COPY_SUCCESS);
        e.clearSelection();
      });
      clipboard.on('error', function(e) {
        //您可以加入失败提示
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        fail_prompt(COPY_FAILURE);
      });
    }
    initCopyCode();

  }(window, document);

  /**
   * 弹出式提示框，默认1.5秒自动消失
   * @param message 提示信息
   * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info
   * @param time 消失时间
   */
  var prompt = function (message, style, time)
  {
      style = (style === undefined) ? 'alert-success' : style;
      time = (time === undefined) ? 1500 : time*1000;
      $('<div>')
          .appendTo('body')
          .addClass('alert ' + style)
          .html(message)
          .show()
          .delay(time)
          .fadeOut();
  };

  // 成功提示
  var success_prompt = function(message, time)
  {
      prompt(message, 'alert-success', time);
  };

  // 失败提示
  var fail_prompt = function(message, time)
  {
      prompt(message, 'alert-danger', time);
  };

  // 提醒
  var warning_prompt = function(message, time)
  {
      prompt(message, 'alert-warning', time);
  };

  // 信息提示
  var info_prompt = function(message, time)
  {
      prompt(message, 'alert-info', time);
  };

</script>


<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>





  <script>setLoadingBarProgress(100);</script>
</body>
</html>
